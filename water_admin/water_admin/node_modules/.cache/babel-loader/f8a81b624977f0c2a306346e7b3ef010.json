{"remainingRequest":"F:\\waterManager\\water_admin\\node_modules\\babel-loader\\lib\\index.js!F:\\waterManager\\water_admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\waterManager\\water_admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\waterManager\\water_admin\\src\\components\\page\\alarmInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\waterManager\\water_admin\\src\\components\\page\\alarmInfo.vue","mtime":1650964202723},{"path":"F:\\waterManager\\water_admin\\babel.config.js","mtime":1646632679840},{"path":"F:\\waterManager\\water_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\waterManager\\water_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\waterManager\\water_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\waterManager\\water_admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0Q29ubmVjdCB9IGZyb20gJ0AvYXBpL3VzZXIuanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNoYXJ0SW5zdGFuY2U6IG51bGwsCiAgICAgIC8vIOi/lOWbnuacjeWKoeWZqOeahOaVsOaNrgogICAgICBhbGxEYXRhOiBudWxsLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgLy/lvZPliY3pobXmlbAKICAgICAgdG90YWxQYWdlOiAwLAogICAgICAvL+aAu+mhteaVsAogICAgICB0aW1lcklkOiBudWxsLAogICAgICAvLyDlrprml7blmajmoIfor4YsCiAgICAgIHNob3dDaG9pY2U6IGZhbHNlLAogICAgICAvL+aYr+WQpuaYvuekuuWPr+mAiemhuQogICAgICB0eXBlOiAnbGluZScsCiAgICAgIHRpdGxlRm9udFNpemU6IG51bGwgLy/mjIfmmI7moIfpopjlrZfkvZPlpKflsI8KCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIOWGjee7hOS7tuWIm+W7uuWujOaIkOaXtuWIm+W7uuWbnuiwg+WHveaVsAogICAgdGhpcy4kc29ja2V0LnJlZ2lzdGVyQ2FsbEJhY2soImFsYXJtSW5mbyIsIHRoaXMuZ2V0RGF0YSk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0Q2hhcnQoKTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnNjcmVlbkFkYXB0ZXIpOwogICAgdGhpcy5zY3JlZW5BZGFwdGVyKCk7IC8vIGdldENvbm5lY3QoKQogIH0sCiAgZGVzdHJveWVkOiBmdW5jdGlvbiBkZXN0cm95ZWQoKSB7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zY3JlZW5BZGFwdGVyKTsgLy8g6ZSA5q+B5pe25Y+W5raI5Zue6LCD5Ye95pWwCgogICAgdGhpcy4kc29ja2V0LnVuUmVnaXN0ZXJDYWxsQmFjayh0aGlzLmdldERhdGEpOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIOiuvue9rue7meagh+mimOeahOagt+W8jwogICAgY29tU3R5bGU6IGZ1bmN0aW9uIGNvbVN0eWxlKCkgewogICAgICByZXR1cm4gewogICAgICAgIGZvbnRTaXplOiB0aGlzLnRpdGxlRm9udFNpemUgKyAncHgnCiAgICAgIH07CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDliJ3lp4vljJZlY2hhcnRJbnN0YW5jZeWvueixoQogICAgaW5pdENoYXJ0OiBmdW5jdGlvbiBpbml0Q2hhcnQoKSB7CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZSA9IHRoaXMuJGVjaGFydHMuaW5pdCh0aGlzLiRyZWZzLmFsYXJtTGV2ZWwsICdjaGFsaycpOwogICAgICB2YXIgaW5pdE9wdGlvbiA9IHsKICAgICAgICB0aXRsZTogewogICAgICAgICAgdGV4dDogJ+KWjuitpuaIkuasoeaVsOWNoOavlCcsCiAgICAgICAgICBsZWZ0OiAyMCwKICAgICAgICAgIHRvcDogMjAKICAgICAgICB9LAogICAgICAgIGxlZ2VuZDogewogICAgICAgICAgdG9wOiAnMjUlJywKICAgICAgICAgIGljb246ICdjaXJjbGUnCiAgICAgICAgfSwKICAgICAgICBzZXJpZXM6IFt7CiAgICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAgIGxhYmVsOiB7CiAgICAgICAgICAgIHNob3c6IGZhbHNlCiAgICAgICAgICB9LAogICAgICAgICAgZW1waGFzaXM6IHsKICAgICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gZm9ybWF0dGVyKGFyZykgewogICAgICAgICAgICAgICAgLy8gcmV0dXJuIGRhdGEuaW5mbwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYXJnKQogICAgICAgICAgICAgICAgcmV0dXJuIGFyZy5kYXRhYWxhcm1JbmZvOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHJvc2VUeXBlOiAnYXJlYScsCiAgICAgICAgICByYWRpdXM6IFszMCwgOTBdLAogICAgICAgICAgY2VudGVyOiBbJzUwJScsICc3MCUnXSwKICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICBib3JkZXJSYWRpdXM6IDUKICAgICAgICAgIH0KICAgICAgICB9XSwKICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgdHJpZ2dlcjogJ2l0ZW0nLAogICAgICAgICAgZm9ybWF0dGVyOiAie2J9OiB7Y33mrKEgKOWNoOavlHtkfSUpIiAvL+aooeadv+WPmOmHj+aciSB7YX3jgIF7Yn3jgIF7Y33jgIF7ZH3vvIzliIbliKvooajnpLrns7vliJflkI3vvIzmlbDmja7lkI3vvIzmlbDmja7lgLzvvIznmb7liIbmr5TjgIIKCiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmNoYXJ0SW5zdGFuY2Uuc2V0T3B0aW9uKGluaXRPcHRpb24pOwogICAgfSwKICAgIGdldERhdGE6IGZ1bmN0aW9uIGdldERhdGEocmV0KSB7CiAgICAgIHRoaXMuYWxsRGF0YSA9IEpTT04ucGFyc2UocmV0KTsKICAgICAgdGhpcy51cGRhdGVDaGFydCgpOwogICAgfSwKICAgIC8vIOabtOaWsOWbvuihqAogICAgdXBkYXRlQ2hhcnQ6IGZ1bmN0aW9uIHVwZGF0ZUNoYXJ0KCkgewogICAgICB2YXIgc2VyaWVzZGF0YSA9IHRoaXMuYWxsRGF0YS5hbGFybVdhdGVyLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2YWx1ZTogaXRlbS5hbGFybVN1bSwKICAgICAgICAgIG5hbWU6IGl0ZW0uYWxhcm1MZXZlbCArICLnuqforabmiJIiCiAgICAgICAgfTsKICAgICAgfSk7IC8vIHZhciBzZXJpZXNkYXRhID0gW3sKICAgICAgLy8gICAgIHZhbHVlOiAnMTAnLAogICAgICAvLyAgICAgbmFtZTogJ+S4gOe6p+itpuaIkicsCiAgICAgIC8vICAgICBhbGFybUluZm86ICfkuIDnuqforabmiJLmsLTkvY3pq5jluqYyMDBtbScKICAgICAgLy8gfSwgewogICAgICAvLyAgICAgdmFsdWU6ICcyMCcsCiAgICAgIC8vICAgICBuYW1lOiAn5LqM57qn6K2m5oiSJywKICAgICAgLy8gICAgIGFsYXJtSW5mbzogJ+S6jOe6p+itpuaIkuawtOS9jemrmOW6pjIwMG1tJwogICAgICAvLyB9LCB7CiAgICAgIC8vICAgICB2YWx1ZTogJzMwJywKICAgICAgLy8gICAgIG5hbWU6ICfkuInnuqforabmiJInLAogICAgICAvLyAgICAgYWxhcm1JbmZvOiAn5LqM57qn6K2m5oiS5rC05L2N6auY5bqmMjAwbW0nCiAgICAgIC8vIH0sIHsKICAgICAgLy8gICAgIHZhbHVlOiAnNTAnLAogICAgICAvLyAgICAgbmFtZTogJ+Wbm+e6p+itpuaIkicsCiAgICAgIC8vICAgICBhbGFybUluZm86ICfkuInnuqforabmiJLmsLTkvY3pq5jluqYyMDBtbScKICAgICAgLy8gfV0KCiAgICAgIHZhciBvcHRpb24gPSB7CiAgICAgICAgc2VyaWVzOiBbewogICAgICAgICAgZGF0YTogc2VyaWVzZGF0YSwKICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICBub3JtYWw6IHsKICAgICAgICAgICAgICBjb2xvcjogZnVuY3Rpb24gY29sb3IocGFyYW1zKSB7CiAgICAgICAgICAgICAgICB2YXIgY29sb3JMaXN0ID0gWyJyZWQiLCAib3JhbmdlIiwgInJnYigxOSwxMTIsMjUxKSIsICJncmVlbiJdOwogICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yTGlzdFtwYXJhbXMuZGF0YUluZGV4XTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9XQogICAgICB9OwogICAgICB0aGlzLmNoYXJ0SW5zdGFuY2Uuc2V0T3B0aW9uKG9wdGlvbik7CiAgICB9LAogICAgLy8g5bGP5bmV5aSn5bCP6YCC6YWNIOWbvuagh+iHqumAguW6lAogICAgc2NyZWVuQWRhcHRlcjogZnVuY3Rpb24gc2NyZWVuQWRhcHRlcigpIHsKICAgICAgLy8g5b6X5Yiw5Zu+5qCH5a655Zmo5a695bqmLeOAi+iOt+WPluWtl+S9k+Wkp+WwjwogICAgICB0aGlzLnRpdGxlRm9udFNpemUgPSB0aGlzLiRyZWZzLmFsYXJtTGV2ZWwub2Zmc2V0V2lkdGggLyAxMDAgKiAzLjY7CiAgICAgIHZhciBhZGFwdGVyT3B0aW9uID0gewogICAgICAgIHRpdGxlOiB7CiAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgZm9udFNpemU6IHRoaXMudGl0bGVGb250U2l6ZQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgLy/lm77kvovlpKflsI8KICAgICAgICBsZW5ndGg6IHsKICAgICAgICAgIGl0ZW1XaWR0aDogdGhpcy50aXRsZUZvbnRTaXplIC8gMiwKICAgICAgICAgIGl0ZW1IZWlnaDogdGhpcy50aXRsZUZvbnRTaXplIC8gMiwKICAgICAgICAgIGl0ZW1HYXA6IHRoaXMudGl0bGVGb250U2l6ZSAvIDIsCiAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgZm9udFNpemU6IHRoaXMudGl0bGVGb250U2l6ZSAvIDIKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5zZXRPcHRpb24oYWRhcHRlck9wdGlvbik7CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5yZXNpemUoKTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;AAeA,SACAA,UADA,QAEA,eAFA;AAGA;AACAC,MADA,kBACA;AACA;AACAC,yBADA;AAEA;AACAC,mBAHA;AAIAC,oBAJA;AAIA;AACAC,kBALA;AAKA;AACAC,mBANA;AAMA;AACAC,uBAPA;AAOA;AACAC,kBARA;AASAC,yBATA,CASA;;AATA;AAWA,GAbA;AAcAC,SAdA,qBAcA;AACA;AACA;AACA,GAjBA;AAkBAC,SAlBA,qBAkBA;AACA;AACAC;AACA,yBAHA,CAIA;AACA,GAvBA;AAwBAC,WAxBA,uBAwBA;AACAD,6DADA,CAEA;;AACA;AACA,GA5BA;AA6BAE;AACA;AACAC,YAFA,sBAEA;AACA;AACAC;AADA;AAIA;AAPA,GA7BA;AAsCAC;AACA;AACAC,aAFA,uBAEA;AACA;AACA;AACAC;AACAC,yBADA;AAEAC,kBAFA;AAGAC;AAHA,SADA;AAMAC;AACAD,oBADA;AAEAE;AAFA,SANA;AAUAC;AACAjB,qBADA;AAEAkB;AACAC;AADA,WAFA;AAKAC;AACAF;AACAC,wBADA;AAEAE;AACA;AACA;AACA;AACA;AANA;AADA,WALA;AAeAC,0BAfA;AAgBAC,0BAhBA;AAiBAC,gCAjBA;AAkBAC;AACAC;AADA;AAlBA,UAVA;AAgCAC;AACAR,oBADA;AAEAS,yBAFA;AAGAP,yCAHA,CAGA;;AAHA;AAhCA;AAuCA;AACA,KA5CA;AA6CAQ,WA7CA,mBA6CAC,GA7CA,EA6CA;AACA;AACA;AAEA,KAjDA;AAkDA;AACAC,eAnDA,yBAmDA;AACA;AACA;AACAC,8BADA;AAEAC;AAFA;AAIA,OALA,EADA,CAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACAhB;AACAxB,0BADA;AAEAgC;AACAS;AACAC;AACA;AACA;AACA;AAJA;AADA;AAFA;AADA;AAeA;AACA,KA3FA;AA4FA;AACAC,iBA7FA,2BA6FA;AACA;AACA;AACA;AACAzB;AACA0B;AACA7B;AADA;AADA,SADA;AAMA;AACA8B;AACAC,2CADA;AAEAC,2CAFA;AAGAC,yCAHA;AAIAJ;AACA7B;AADA;AAJA;AAPA;AAgBA;AACA;AACA;AAlHA;AAtCA","names":["getConnect","data","chartInstance","allData","currentPage","totalPage","timerId","showChoice","type","titleFontSize","created","mounted","window","destroyed","computed","comStyle","fontSize","methods","initChart","title","text","left","top","legend","icon","series","label","show","emphasis","formatter","roseType","radius","center","itemStyle","borderRadius","tooltip","trigger","getData","ret","updateChart","value","name","normal","color","screenAdapter","textStyle","length","itemWidth","itemHeigh","itemGap"],"sourceRoot":"src/components/page","sources":["alarmInfo.vue"],"sourcesContent":["<!--\r\n * @Author: Tashany\r\n * @Date: 2022-04-13 20:51:01\r\n * @LastEditors: Tashany\r\n * @LastEditTime: 2022-04-26 17:10:02\r\n * @Description: file content\r\n * @FilePath: \\water_admin\\src\\components\\page\\alarmInfo.vue\r\n-->\r\n<template>\r\n    <dv-border-box-1 class=\"com-container\">\r\n        <div class=\"com-chart\" ref=\"alarmLevel\"></div>\r\n    </dv-border-box-1>\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        getConnect\r\n    } from '@/api/user.js'\r\n    export default {\r\n        data() {\r\n            return {\r\n                chartInstance: null,\r\n                // 返回服务器的数据\r\n                allData: null,\r\n                currentPage: 1, //当前页数\r\n                totalPage: 0, //总页数\r\n                timerId: null, // 定时器标识,\r\n                showChoice: false, //是否显示可选项\r\n                type: 'line',\r\n                titleFontSize: null //指明标题字体大小\r\n            }\r\n        },\r\n        created() {\r\n            // 再组件创建完成时创建回调函数\r\n            this.$socket.registerCallBack(\"alarmInfo\", this.getData)\r\n        },\r\n        mounted() {\r\n            this.initChart()\r\n            window.addEventListener('resize', this.screenAdapter)\r\n            this.screenAdapter()\r\n            // getConnect()\r\n        },\r\n        destroyed() {\r\n            window.removeEventListener('resize', this.screenAdapter)\r\n            // 销毁时取消回调函数\r\n            this.$socket.unRegisterCallBack(this.getData)\r\n        },\r\n        computed: {\r\n            // 设置给标题的样式\r\n            comStyle() {\r\n                return {\r\n                    fontSize: this.titleFontSize + 'px'\r\n                }\r\n\r\n            }\r\n        },\r\n        methods: {\r\n            // 初始化echartInstance对象\r\n            initChart() {\r\n                this.chartInstance = this.$echarts.init(this.$refs.alarmLevel, 'chalk')\r\n                const initOption = {\r\n                    title: {\r\n                        text: '▎警戒次数占比',\r\n                        left: 20,\r\n                        top: 20\r\n                    },\r\n                    legend: {\r\n                        top: '25%',\r\n                        icon: 'circle',\r\n                    },\r\n                    series: [{\r\n                        type: 'pie',\r\n                        label: {\r\n                            show: false\r\n                        },\r\n                        emphasis: {\r\n                            label: {\r\n                                show: true,\r\n                                formatter: arg => {\r\n                                    // return data.info\r\n                                    // console.log(arg)\r\n                                    return arg.dataalarmInfo\r\n                                }\r\n                            }\r\n                        },\r\n                        roseType: 'area',\r\n                        radius: [30, 90],\r\n                        center: ['50%', '70%'],\r\n                        itemStyle: {\r\n                            borderRadius: 5\r\n                        }\r\n                    }, ],\r\n                    tooltip: {\r\n                        show: true,\r\n                        trigger: 'item',\r\n                        formatter: \"{b}: {c}次 (占比{d}%)\" //模板变量有 {a}、{b}、{c}、{d}，分别表示系列名，数据名，数据值，百分比。\r\n                       \r\n                    }\r\n                }\r\n                this.chartInstance.setOption(initOption)\r\n            },\r\n            getData(ret) {\r\n                this.allData = JSON.parse(ret)\r\n                this.updateChart()\r\n\r\n            },\r\n            // 更新图表\r\n            updateChart() {\r\n                var seriesdata = this.allData.alarmWater.map(item => {\r\n                    return {\r\n                        value: item.alarmSum,\r\n                        name: item.alarmLevel + \"级警戒\"\r\n                    }\r\n                })\r\n                // var seriesdata = [{\r\n                //     value: '10',\r\n                //     name: '一级警戒',\r\n                //     alarmInfo: '一级警戒水位高度200mm'\r\n                // }, {\r\n                //     value: '20',\r\n                //     name: '二级警戒',\r\n                //     alarmInfo: '二级警戒水位高度200mm'\r\n                // }, {\r\n                //     value: '30',\r\n                //     name: '三级警戒',\r\n                //     alarmInfo: '二级警戒水位高度200mm'\r\n                // }, {\r\n                //     value: '50',\r\n                //     name: '四级警戒',\r\n                //     alarmInfo: '三级警戒水位高度200mm'\r\n                // }]\r\n                const option = {\r\n                    series: [{\r\n                        data: seriesdata,\r\n                        itemStyle:{\r\n                            normal:{\r\n                                color:function(params){\r\n                                    var colorList = [\"red\", \"orange\",\"rgb(19,112,251)\",\"green\"]\r\n                                    return colorList[params.dataIndex]\r\n                                }\r\n                            }\r\n                        }\r\n                    }]\r\n                }\r\n\r\n\r\n                this.chartInstance.setOption(option)\r\n            },\r\n            // 屏幕大小适配 图标自适应\r\n            screenAdapter() {\r\n                // 得到图标容器宽度-》获取字体大小\r\n                this.titleFontSize = (this.$refs.alarmLevel.offsetWidth / 100) * 3.6\r\n                const adapterOption = {\r\n                    title: {\r\n                        textStyle: {\r\n                            fontSize: this.titleFontSize\r\n                        }\r\n                    },\r\n                    //图例大小\r\n                    length: {\r\n                        itemWidth: this.titleFontSize / 2,\r\n                        itemHeigh: this.titleFontSize / 2,\r\n                        itemGap: this.titleFontSize / 2,\r\n                        textStyle: {\r\n                            fontSize: this.titleFontSize / 2\r\n                        }\r\n                    }\r\n                }\r\n                this.chartInstance.setOption(adapterOption)\r\n                this.chartInstance.resize()\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n\r\n<style lang=\"less\" scoped>\r\n    .title {\r\n        position: absolute;\r\n        left: 20px;\r\n        top: 20px;\r\n        z-index: 10;\r\n        color: white;\r\n\r\n        .title-icon {\r\n            margin-left: 10px;\r\n            cursor: pointer;\r\n        }\r\n    }\r\n</style>"]}]}